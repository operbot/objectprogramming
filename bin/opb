#!/usr/bin/env python3
# This file is placed in the Public Domain.
# pylint: disable=C0115,C0116,C0209


"object programming bot"


NAME = "opb"


import atexit
import os
import readline
import rlcompleter
import signal
import sys
import termios
import time


sys.path.insert(0, os.getcwd())


from op import Command, Cfg, Event, Handler, Wd
from op import parse, printable, scan, scandir
from opm import cmds, irc, rss
from opm.irc import Config


from opsys import Console, banner, importer, init, setcompleter, wrap


Wd.workdir = os.path.expanduser("~/.%s" % NAME)


Config.nick = NAME
Config.channel = "#%s" % NAME
Config.realname = NAME
Config.username = NAME


scan(cmds)
scan(irc)
scan(rss)


def main():
    parse(" ".join(sys.argv[1:]))
    banner(Cfg)
    scandir("mod", importer)
    bot = irc.init()
    print(printable(bot.cfg, "nick,channel,server,port,sasl"))
    rss.init()
    csl = Console()
    csl.start()
    csl.wait()


wrap(main)

